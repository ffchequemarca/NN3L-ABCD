function [Y,Xf,Af] = NN_Toolbox(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 16-Oct-2018 17:33:26.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 16xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 10xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0;0;0.0235294117647059;0.0117647058823529;0.0235294117647059;0.0235294117647059;0.0235294117647059;0.0470588235294118;0.0470588235294118;0.0313725490196078;0.0941176470588235;0.0941176470588235;0.0745098039215686;0.0941176470588235;0.0627450980392157;0];
x1_step1.gain = [2;2;2.15189873417722;2.36111111111111;2.04819277108434;2.04819277108434;2.04819277108434;2.09876543209877;2.09876543209877;2.06477732793522;2.20779220779221;2.21739130434783;2.17021276595745;2.21739130434783;2.13389121338912;2];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.0104021118148422964;1.6658682651947318565;1.5958559536258927203;-1.2429491957115330614;-1.1389714991165278413;0.68436974135676875708;-0.77410163718182667392;-0.80106542020009718907;-0.97261076792575940075;-0.746127601180385569;0.051844663833267523589;-0.52150834587031125178;-0.16350895038857585218;-0.34270200090038005492;0.82711035571479363249;-0.42314012802183198492;0.60253820515436307126;-0.88937923700498322521;1.1565774783317452901;-1.1635697434384106863;-1.5038470347749639533;1.0293221635778058154;-1.551804864749937618;1.7575869955846226134;1.7755507992711543341];
IW1_1 = [0.7158865647943554178 -0.12244188839142022829 0.053713892570161667073 -0.90549980898249260441 0.21407575250160765234 -0.61034862294678049466 0.37786700887783453151 -0.71742755927611956412 -0.62008762989460819437 0.04703571258141721334 0.27028074601648099939 -0.37285982405425022179 -0.0097887157231549282166 0.51946717689507104776 -0.28320966258070962018 0.016369116076069840926;-0.34111339748390229198 -0.20225426274996988196 0.12510929382548957589 -0.16935445124443598841 0.38795314082405207845 0.065329709052565965166 -0.059602055141979415342 -0.88597404085500330861 0.019844092152281181396 -0.68180788645148293625 -0.35579350900972567251 -0.52620301277515635352 0.28052926209739581509 0.11750360032057237392 0.37908470697365892477 0.60713986151201260189;-0.41676962211110635259 0.25863638943060035524 0.24673388485677441584 0.38758972675500896754 -0.44358302055707898859 0.5756724206001466726 -0.018638654522668329783 0.33894711162723079045 0.26099888397778164828 -0.21924081676163628685 0.26593354119830736604 -0.74633844574849894649 -0.39487409053277922055 -0.28273601476215026729 0.15687697697913527417 -0.22396940663903885937;0.40302040497623892179 -0.55750592004261989576 -0.3174806686834853453 -0.1062093739382700408 0.066292705389034478625 -0.13269431432084771716 0.56085968040315026251 -0.32923109142426099094 -0.15055913681715130115 0.41832228005806748605 -0.19750506840884499149 -0.43398051458748104769 0.3292750728543110128 0.081216412493285913832 0.31085834421797658988 -0.43442859899391106371;-0.061238956636108066167 0.011637641669932641264 -0.4016009566365867367 -0.12216859983884736929 0.082921814442490221486 0.18348222862313531834 0.20209345731589983819 -0.53219748116334630872 0.77219824148281901444 0.66304401603403662069 -0.59591269710266425719 -0.089772754085604353214 0.33797689437461947426 -0.58971153029698597514 0.40740935550675733134 -0.33157105496618777263;-0.18038056210177053074 -0.17276867142141463796 0.37334287079268918541 0.41445948438447127726 0.044306008407644356661 -0.0085292156417049180828 0.41112842101785829207 0.081811088869229164899 0.2888663802077103826 -0.65299798776975215286 -0.58499173890926225994 0.2221546804359027516 -0.58504082551784952759 -0.30118484700969716528 -0.1911127685225459949 -0.63692408307052617022;0.59756559570760281463 -0.53097074308730785042 -0.1498622721020581583 0.35950653524193221244 0.0043766992313509778256 -0.088447837019979769213 -0.37068017949621578921 -0.65774714879863327432 0.35499458304203113101 0.60811904863905807961 -0.20259358109896302702 -0.24265061672005594495 -0.3109047668975148393 0.78676240036773137376 0.36819114139495368043 0.23757053154442819842;-0.34746086926755959112 -0.30689481740401886034 -0.3238744285072850948 -0.25812181796297029024 0.57893223320528719444 0.14389077813827810814 0.29060579741922437647 0.25033618211884567373 0.48284628742569618565 0.48870386122061226786 0.54719325333851098758 0.16079794314811596267 -0.26689772081107937529 0.36026588703397149915 -0.53503538874140421644 0.13863595248663673765;0.4566757344480786851 0.62399678359925625504 0.078935771811576377344 -0.07386447888505721926 -0.1467939761334779436 0.00071348121599354441535 0.17606949960326329085 -0.085084204554404435639 0.13748525385542048616 0.35226079465044668471 -0.041073719530354914353 -0.31590262000486191152 0.622596012137831889 -0.76349257536073178443 0.023323121953791915717 0.11206890202965572034;0.14597627715551611538 -0.22530659838848984822 0.2303781463246293848 0.45795925276673110638 0.51596086960389064835 -1.1475033759699579949 -0.068434017107982261785 0.032877700712098667513 0.31038265597919439953 0.31782429675266610225 -0.072903044121133381283 0.28994431790585006858 0.13449741894885722249 0.3181519992857421153 -0.49750107821751987647 0.42395467246158802244;0.23083464240269896406 -0.24371953360309775438 -0.027130704544854722382 -0.082798597697021830699 0.69489447474827470419 -0.29371505692918364883 0.47823177818971340791 -0.14265704917510976801 0.17108765791678412493 -0.54773641455905230924 0.48623947085168983673 0.53264132016664267333 -0.24827931285524484917 -0.96929427270510148951 0.37016605421844583912 0.16381730896970536637;0.093877305097454261107 -0.16705606374608469866 -0.56730667332718287543 0.34272554875793270757 0.26201222469119805902 -0.29183191940771141537 0.13560494096355929505 0.45191917555419819363 0.11432220814485272165 -0.26562487997558031916 0.61999640963131930071 0.70597585064815471245 -0.9286495213634980983 -0.25987286483754856725 -0.061162291186461173464 0.29537223066492224177;0.22368302919872889989 -0.34701898967060251788 -0.10073171822540545606 0.074432396677435674892 -0.63485575386844850243 -0.29398751381011406503 -0.69063708153880054574 0.58378726972062033873 0.66574256063286729734 0.5682871725157223608 0.38110104012576118127 -0.046839106597271938648 0.2122212304785210113 0.23773384762574056861 -0.20618135313311458656 0.17901222385735460207;-0.32305990298422287976 -0.3216917797349779784 0.19416958033090142566 0.10059472126789908986 -0.33272316988987737929 0.760662962188166758 0.45937207459832890555 -0.020283219525329729271 -0.38370690528514062034 0.22718329183351937406 0.58348044644870000752 0.19326185947636603801 0.2889763696940024218 -0.12351391316941590093 -0.69690119881833700877 0.64452300449840305152;0.94985927106457934688 0.054865347388528565298 0.022921986334993968426 -0.21754678206331279355 -0.62528077264685311132 -0.23611865484697402984 -0.48027622906340694531 0.45496818661744120593 0.3033995064592008295 -0.11135243432159885879 0.31405706147795259264 0.098103419600063385131 0.56121264865155739976 0.04791467314499544411 -0.38630949339052977898 0.39728867574148463149;-0.70134301666879073078 -0.94231177097245233387 -0.099475408997603292915 0.29732003160292735933 -0.16832992588132644762 -0.069055458361865315609 0.18434097744319763446 -0.5781222822860592192 -0.99869221120704643191 0.067907991845538320796 0.28179357209482303048 0.24531464108928630052 0.39062610990797452803 -0.16660653104889003306 -0.61650904465544797972 0.092713981843868226163;0.3770542758388770177 -0.47320299351173822355 -0.0032488947770359932754 0.32106930515733050902 -0.6081130805731516098 -0.090664749965689725442 -0.11877620904275862368 0.29437100238711000344 0.11275141749435885208 0.08215432725900662092 0.37011892026356030261 0.79643307089489734363 -0.27829833456244568168 0.36960510268201440809 -0.37836795554292740329 -0.34204311733829395603;0.077040545750619943144 -0.3612284191613703288 -0.11449435260717649721 -1.376962322068073119 -0.39311795077317340796 -0.0070231069598088290834 -0.44531113182909637382 -0.07322732893763031492 0.12825733314715664912 -0.44798131900888993329 0.11996829988966736802 0.46155069232225287568 0.31612754592205166704 0.26002635579305899416 -0.39999311931785752616 -0.79007920999203906653;0.34484169645521062231 0.50608749077973236297 -0.18744014738187772529 -0.13430185733138802484 -0.23135995939420017642 0.38119314926685660128 0.42927177610775196781 0.22810603056497064101 -0.091334846685137915934 -0.52532023524066251419 -0.18719162342577405633 0.47918108735277148424 0.58074523725626203685 -0.65555379745455577556 -0.49720131372753556542 -0.28816639428976958959;-0.24134204656942714884 -0.052573728170240335844 0.33505143400772202655 0.056485265061790079777 0.41046677790237656724 0.15448339643378555808 0.10835299620983648849 0.49423283354302155468 0.31600871229039129151 -0.11157463918131196867 0.86712090568065935958 0.24325328678974408869 -0.85384647275987146653 -0.34742604634759699511 -0.44753764568046228156 -0.33848693203970919852;-0.53793998196596914951 -0.68658284322892881857 -0.59729012440830087094 0.33279159750717635102 0.081994311765473198994 -0.16624529447880309618 -0.056007088648275263343 -0.75312584189911657706 -0.17548215591170834848 -0.029231524088611592072 0.16367043522453739168 -0.099854449114237436858 0.42070619304731826649 -0.22208955313549580413 -0.41694174741827899622 0.15065053759458180149;0.57873113748033888637 -0.038849424004031622715 -0.067169670654469368354 0.26529679444357157081 -0.80154456758751313483 -0.085808443593165931174 -0.28180232777169411662 0.65690107669653774458 1.1953689079652642935 -0.070747083126879314885 -0.023000496376881729432 -0.11509049110189123466 0.52490519817171465977 0.60401408765695518976 -0.48100633800662229156 -0.26480940789478718544;-0.47261049577877994876 0.24268765669469338775 -0.0488771019505439136 -0.14161437440581353675 0.17668639701582228296 -0.5421928902473786005 -0.67046735572403004522 -0.2497436065027748564 -0.60986262618446673844 -0.40685795722536854946 0.10360874719498618102 0.38143433758225492314 -0.61445955125741524849 0.12021877515416823368 0.32990976286139056528 0.12057753016402153468;0.41777452780835994117 0.59362948293795658739 -0.49591875857710154829 -0.19380916302718192989 0.23802230278719971324 -0.35260989844770240786 0.057922605744925470539 0.72515114475497932656 0.8033321175130246905 -0.30342426689696055941 -0.046015690385168721288 -0.37863935996490788449 -0.27856118194506940267 -0.58330628155087160813 0.013460832399691396999 0.34843533191941478133;0.14937530167183479812 0.062728537341190049315 0.53269700023386579169 -0.15697458836029951068 -0.021911072699574856565 -0.73659015701773833396 0.43717878001796811605 0.70253234781148199417 0.46901799519821213424 -0.33857093682814415336 -0.089799777358053653464 -0.51952328339880626817 0.067619962243168033056 0.00014115508794702164019 -0.41583001280664616539 0.08128301234112783602];

% Layer 2
b2 = [0.55370280194706344989;0.54660129997044160088;0.037687762902991688019;-0.8838789747359964144;-0.63598641820005175074;0.10763129846611184381;0.59427036675654210107;-0.041664613118086016308;0.43389423110633057457;-0.85783478044108585348];
LW2_1 = [-0.066593341428622485068 0.086457135309398552847 -0.015558627643493083692 0.64256943005212285858 -0.71420929356756124307 0.68844647976655526378 0.41584593122615948202 -0.023095642311778297184 0.31388140342300802077 -0.066079938318445358147 0.8005976835314533302 -0.38468242273320163438 0.61329006926755902374 0.046640323255366752941 -0.2172627611719653018 0.17784843782667875134 -0.23036707985678772648 0.1155980783504837045 -0.82023398252386714447 0.35756348250663572141 -0.037490253579730403732 0.43891439297805678876 0.75060671693912417446 -0.36587660360769619361 0.10224009443592227409;0.029785926161087140918 -0.1259146261024196578 0.49799108241959416654 0.26580826073360086514 -0.32378417763273620311 -0.56292569359783972693 0.08311178688752007826 -1.1970950076141897434 0.91678958808281540982 0.76668910465234962892 0.25042483056532449659 0.38463945527056120355 0.85459072734050878228 0.26302883363399531813 -1.0688287881083269326 -0.04328439020656501407 -0.24437563083217658799 0.27636252915324971413 0.38699071877656177065 0.09208340214206789387 -0.36259257919494508604 -0.38363442698314459411 -0.19544954349220175494 -0.35033273075109783168 -0.028268949220162722935;0.53847275026102858764 -0.24197198895865787427 -0.51191820465863080436 0.40949237313733843902 0.87792357410232080284 0.7599924879837434144 0.11844559951785900431 -0.20580438813565862799 -1.7044852195100379522 0.45049134401344759215 0.65195179952661863609 -0.2756229157990728873 0.57884421804445784776 -0.63820382311024559385 1.2256047730477788171 -0.426612172076498819 0.55699667012019449253 -0.032142157188335795936 0.06547057986982418587 0.98959277848329674221 0.26211841158395299267 -0.58876655439298786199 -0.17342408396458580677 -0.39465887725944903686 0.83115495496359992345;0.41958036164512152455 -0.19335636834361374925 -0.89585753216719898884 -0.62746293253540741386 0.24977021007141686493 -0.74300632031758628848 -0.43462433118795978926 -0.27348437944540437972 -0.44292575500855269066 -0.38808197611935929539 -0.50138328272606991209 0.092890909268513177643 0.046509966392425702852 0.35318659783476663572 -0.27286602551303917874 -0.42313872404435365349 0.41697161015267025785 -0.2268522395126701674 0.17334223210746707577 -0.43124039218362564263 0.10401982547171320648 -0.20719617037593279774 0.043688814239164472375 0.71653228414577141425 -0.42800925614155804766;-1.0057622627381603841 -0.3076539408312730095 0.67461110068257557071 0.76337762229873373787 0.21479933143911106308 -0.22584344051524662955 -0.60564422730348399515 0.085477573591772826322 -0.02987978581104761 0.49345187732574724571 -0.5106543112328194578 -0.05960718501959703236 -0.37351503120751727849 -0.096565449078698406549 0.41761045518166306501 0.11043006279647656076 -0.6921615491995967151 -0.30930366861397601275 -0.083382825651012584811 -0.35447875766839659351 -0.4294205033019296569 -0.63417835913691289473 0.27172204946637235068 0.28967391050279261977 -0.72220671643261902251;-0.39201780388480944595 0.4470501256616621899 0.39806480989577452956 0.98838707157150718086 -0.23367504825604154539 0.42642198254190599727 0.35299525191799657753 -0.28450579198147213367 0.16181243717450741193 -0.4151979668006647306 0.66540106467408366431 -0.51044184591789876215 -0.5344750654579735194 0.91298861731645963857 -0.4985676779678607784 -1.1427120733325470958 -0.67052675560997943016 0.12153114775762145772 -1.2596861137996677726 0.61857149308454606462 -0.51428761117774723921 0.76402536308478574689 0.16456023375352724081 -0.52385616402343004872 -0.56605336263954031395;0.44384823867292061417 0.024653429997636189946 0.62424290081472444403 0.41374128770082113649 -0.059249489051241222004 0.5273462903146536318 0.19462704929178087365 -0.022842169332641732576 0.39123940563855774677 0.47600423944699671308 -1.0133024795221334813 0.77422999676850001727 -0.32920464694763285074 0.094599818394753315554 -0.17215778091202832423 -0.22429329038312209588 0.31378226799188502216 -0.81852893988647190682 0.028472268168664785493 -0.24026413092371079472 0.45365601080845324722 -0.1618344155995140865 0.33038147658744082547 -0.31367387470777963188 -0.83329551502224841197;0.65723918119782043235 0.32172875579621579289 0.80782464685083077427 -0.36291152522272973613 0.61478995659130608598 0.087410167465462304537 -0.59182495331543072403 -0.23085203723610900339 0.82368895651348061904 0.25191761508826376881 -0.15759235532143678338 0.32931759578942954025 -0.29741446757705231052 -0.1818948513716465154 0.41662579460854332059 0.24924368852986306111 -0.039961637378848613444 0.11776393805346115073 -0.49734355285222398013 0.80915142427431008265 0.1749545555065707414 0.39534683163871453537 0.35654334711699414706 -0.58258071343866812963 0.43120053569841720886;1.0415845595346393537 -0.68715085088165184235 -0.8994560413797870746 -0.58148186458698292167 0.66883793352277531863 0.7016447376783494505 0.133984491402582645 -1.0629331165089874744 -0.088729082425496458297 0.76275093818972694582 0.52836897785455760879 -0.28313380803847010281 0.49286973063724442978 0.65626545924829271517 -0.061772375310606697507 1.7048471087410315139 -0.12038630357293858553 -0.41974839632704341597 0.20269516475068188877 -0.061142157729494550633 -0.91451312354721425724 0.45345252530938051638 0.21897645415270342029 0.99074989567219551301 -0.56343810394928184326;-0.26469814132817470753 0.45057229292264977527 -0.21642995877349602285 0.58084262989986035208 -0.047738385362001450885 -0.52428210032928113105 -0.1540665568000894603 -0.24274501063708292525 -0.40966934543801114543 -0.12915759881936483833 0.35921055161761672458 -0.13037787086429422634 0.4805136273759097465 0.19257456713590709318 0.48987043715339601002 0.17638250820968054411 -0.55232254561764260181 0.9325332138862501008 0.092704654210006731674 0.81883522394024033098 -0.66194232931488117266 -0.89403706619320910676 -0.85633361869698343405 -0.44022610194929379102 0.78496403802920189374];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [2;2;2;2;2;2;2;2;2;2];
y1_step1.xoffset = [0;0;0;0;0;0;0;0;0;0];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
